<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Practical 1: Linear Regression</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f4f9; padding: 40px; text-align: center; }
        .box { background: white; padding: 30px; border-radius: 10px; display: inline-block; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        #log { margin-top: 20px; font-family: monospace; color: #d63031; font-weight: bold; }
        .code-style { background: #dfe6e9; padding: 2px 5px; border-radius: 4px; font-family: monospace; }
    </style>
</head>
<body>

<div class="box">
    <h2>Practical 1: Synthetic Linear Regression</h2>
    <p>Using <span class="code-style">tf.sequential()</span> and <span class="code-style">tf.layers.dense()</span></p>
    
    <button id="train-btn" onclick="train()">Train Model</button>
    
    <div id="log">Status: Ready to train</div>
</div>

<script>
    async function train() {
        const log = document.getElementById('log');
        document.getElementById('train-btn').disabled = true;

        // 1. Prepare Synthetic Data (x and y)
        // Rule: y = 2x - 1
        const xData = [-1, 0, 1, 2, 3, 4];
        const yData = [-3, -1, 1, 3, 5, 7];

        const xs = tf.tensor2d(xData, [6, 1]);
        const ys = tf.tensor2d(yData, [6, 1]);

        // 2. Define the Model Architecture
        const model = tf.sequential();
        
        // Add a single dense layer
        // units: 1 (one output), inputShape: [1] (one input)
        model.add(tf.layers.dense({ units: 1, inputShape: [1] }));

        // 3. Compile the Model
        // Optimizer: Stochastic Gradient Descent (sgd)
        // Loss: Mean Squared Error (common for regression)
        model.compile({
            optimizer: 'sgd',
            loss: 'meanSquaredError'
        });

        log.innerText = "Training... (Check Console for Loss)";

        // 4. Train the Model
        await model.fit(xs, ys, {
            epochs: 250,
            callbacks: {
                onEpochEnd: (epoch, logs) => {
                    if (epoch % 50 === 0) {
                        console.log(`Epoch ${epoch}: loss = ${logs.loss.toFixed(4)}`);
                    }
                }
            }
        });

        // 5. Predict an unseen value (e.g., x = 10)
        // Expected: 2(10) - 1 = 19
        const prediction = model.predict(tf.tensor2d([10], [1, 1]));
        const result = await prediction.data();

        log.style.color = "#2d3436";
        log.innerHTML = `Training Complete!<br>Prediction for x=10: <b>${result[0].toFixed(2)}</b><br>(Target: 19.00)`;
    }
</script>
</body>
</html>